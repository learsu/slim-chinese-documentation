<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>值对象 - Slim 3.0 中文文档</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Slim 3.0 中文文档</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
        <span>开始</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../start/installation">安装</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../start/web-servers">Web 服务器</a>
                    
                </li>
            
        

    
        
        <span>基本概念</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../objects">对象</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../di">依赖注入</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../middleware">中间件</a>
                    
                </li>
            
                <li class="toctree-l1 current">
                    <a class="current" href=".">值对象</a>
                    
                        <ul>
                        
                            <li class="toctree-l2"><a href="#_1">什么是值对象？</a></li>
                            
                        
                            <li class="toctree-l2"><a href="#_2">如何修改值对象？</a></li>
                            
                        
                        </ul>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../life-cycle">生命周期</a>
                    
                </li>
            
        

    
        
        <span>对象</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../objects/environment">环境</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../objects/request">请求</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../objects/response">响应</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../objects/router">路由器</a>
                    
                </li>
            
        

    
        
        <span>特性</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../features/templates">视图和模板</a>
                    
                </li>
            
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../../caching">缓存</a>
            </li>
        

    
        
        <span>错误处理</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../handlers/error">500 Server Error</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../handlers/not-found">404 Not Found</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../handlers/not-allowed">405 Not Allowed</a>
                    
                </li>
            
        

    
        
        <span>贡献者</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../contributors/strategy">分支策略</a>
                    
                </li>
            
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="../.."></a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    <li>值对象</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h1 id="_1">什么是值对象？</h1>
<p>Each Slim application's Request and Response objects are <a href="http://en.wikipedia.org/wiki/Value_object"><em>immutable value objects</em></a>. They can be "changed" only by requesting a cloned version that has updated property values.</p>
<p>Value objects are a source of constant opinion. Some developers love them, and other developers hate them. I was skeptical when Matthew Weier O'Phinney first suggested I use them. After implementing value objects, however, I am 100% on board. Immutable value objects provide stability and predictability that are otherwise impossible with object references.</p>
<p>Each Slim application starts with an initial Request and Response object pair. These objects are passed into each application middleware layer, and each middleware layer is free to use these objects as it deems fit. If Slim used object references, each middleware layer could never be certain of its own Request and Response objects if further interior middleware can update the same object references. Instead, Slim uses immutable value objects. This means that each middleware's Request and Response objects always remain the same, and they cannot be changed by other middleware. If a middleware wants to modify the Request or Response object, it must create a <em>cloned</em> version with updated properties.</p>
<p>Value objects have a small inherent overhead becaue they must be cloned when their properties are updated. This overhead is minimal and does not affect application performance in any meaningful way.</p>
<h1 id="_2">如何修改值对象？</h1>
<p>You cannot modify a value object. You can, however, request a copy of a value object that contains your desired changes. Slim's Request and Response objects implement the PSR-7 message interfaces. These interfaces provide methods that have the <code>with</code> prefix, and you can invoke these methods to <em>clone</em> value objects and apply updated properties. For example, the Response object has a <code>withHeader($name, $value)</code> method that returns a cloned value object with a new HTTP header.</p>
<pre><code class="php">$newResponse = $oldResponse-&gt;withHeader(
    'Content-Type',
    'application/json'
);
</code></pre>


            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../life-cycle" class="btn btn-neutral float-right" title="生命周期"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../middleware" class="btn btn-neutral" title="中间件"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
      <span><a href="../middleware" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../life-cycle" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
</body>
</html>